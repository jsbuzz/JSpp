<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
	<title>js++ iterator demo</title>
	
	<style type="text/css">
		* {
			font-family: Calibri,Helvetia,sans-serif;
		}

		body {
			padding:5px 20px;
			margin:0;
		}
		pre {
			margin:0;
			padding:0;
		}

	</style>

	<script type="text/javascript" src="../js++.js"></script>
	<script type="text/javascript" src="iterators.js"></script>
	<script type="text/javascript">

	_DEBUG = false;
	
	function debug(txt,toConsole)
	{
		document.getElementById('debug').innerHTML = document.getElementById('debug').innerHTML+'<span>'+(
				typeof(txt)!='string' ? 
					JSON.stringify(txt) : 
					txt.replace(/</g,'&lt;').replace(/>/g,'&gt;')
			)+'</span>\n';
		if(toConsole && console && typeof(console.info) == 'function')
			console.info(txt);
	}


	function loadTest()
	{
		var debugIterator = function(i){
			debug(i.key()+' : '+i.current());
		};

		// ArrayIterator test
		debug('\nforeach<ArrayIterator>: [1,2,3]');
		var array = [1,2,3],
		    ai = new ArrayIterator(array);

		ai.foreach(debugIterator);


		// Odd test
		debug('\nforeach<Odd(ArrayIterator)>: [1,2,3]');
		var odd = Odd(ai);

		odd.foreach(debugIterator);
		
		// Even test
		array.push(4);
		debug('\nforeach<Even(ArrayIterator)>: [1,2,3,4]');
		var even = Even(ai);

		even.foreach(debugIterator);


		// ObjectIterator test
		debug('\nforeach<ObjectIterator>: {a:1,b:2,c:3}');
		var object = {a:1,b:2,c:3},
		    oi = new ObjectIterator(object);

		Iterator.foreach(oi,debugIterator);


		// PropertyIterator test
		debug('\nforeach<PropertyIterator>: {a: function(){return 1}, b:2, c: function(){return 3}, d:4}');
		var object = {a:function(){return 1},b:2,c:function(){return 3},d:4},
		    pi = new PropertyIterator(object);

		pi.foreach(debugIterator);


		// MethodIterator test
		debug('\nforeach<MethodIterator>: {a: function(){return 1}, b:2, c: function(){return 3}, d:4}');
		var mi = new MethodIterator(object);

		mi.foreach(debugIterator);

		
		// DOM_Iterator test
		var dom = new DOM_Iterator(document.body),
		    puffer = []; // we shouldn't write the dom while reading it

		dom.foreach(function(i){
			puffer.push(
				new Array(i.depth()+1).join('\t')
				+ i.key()
				+ (i.key()=='SPAN' ? ' ['+i.current().innerText.replace(/\n/g,'')+']' : '')
			);
		});
		
		debug('\nforeach<DOM_Iterator> : BODY');
		Iterator.foreach(puffer,function(i){
			debug(i.current());
		});
	}
	</script>

</head>

<body onload="loadTest()">
	<pre id="debug"></pre>
</body>
</html>